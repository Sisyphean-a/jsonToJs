# AI助手集成说明

## 功能概述

现在JsonToJs项目已经集成了AI转换助手功能，可以通过自然语言描述来生成JSON转换代码。

## 新增组件

### AITransformAssistant.vue

位置：`src/components/AITransformAssistant.vue`

这是一个独立的AI助手组件，提供以下功能：

1. **JSON结构分析**：自动分析输入的JSON数据结构
2. **自然语言输入**：用户可以用中文描述想要的转换逻辑
3. **AI代码生成**：调用OpenAI API生成相应的JavaScript转换代码
4. **代码自动填充**：生成的代码会自动填充到主编辑器中

## 使用方法

### 1. 配置API密钥

首次使用时，需要配置OpenAI API密钥：

1. 在JsonToJs页面中，如果没有配置API密钥，会显示配置界面
2. 输入您的OpenAI API密钥
3. 点击"保存密钥"按钮
4. 密钥会保存在本地浏览器中，不会上传到服务器

### 2. 使用AI助手

配置密钥后，AI助手界面会出现在代码编辑器上方：

1. **查看JSON结构**：AI助手会自动分析并显示当前JSON的结构
2. **描述转换需求**：在输入框中用中文描述您想要的转换，例如：
   - "提取所有用户的姓名和邮箱"
   - "获取数组中价格大于100的商品"
   - "将用户列表转换为以ID为键的对象"
3. **生成代码**：点击"生成代码"按钮
4. **应用代码**：生成的代码会自动填充到编辑器中

### 3. 重置API密钥

如需更改API密钥：

1. 点击"🔑 重置密钥"按钮
2. 重新输入新的API密钥

## 技术特性

### JSON结构分析

AI助手会智能分析JSON结构，包括：

- 识别数组和对象类型
- 分析嵌套层级关系
- 提取主要字段信息
- 限制分析深度避免过度复杂

### AI提示词优化

系统会生成专门的提示词，包含：

- JSON结构信息
- 用户转换需求
- 代码格式要求
- 错误处理指导

### 代码生成规范

生成的代码具有以下特点：

- 仅包含函数体内容，可直接在编辑器中使用
- 支持ES6+语法
- 包含错误处理逻辑
- 可使用jsonpath库进行复杂查询
- 具有良好的代码注释

## 示例

### 输入示例

JSON数据：
```json
{
  "users": [
    {
      "id": 1,
      "name": "张三",
      "email": "zhangsan@example.com",
      "age": 25,
      "department": "技术部"
    },
    {
      "id": 2,
      "name": "李四",
      "email": "lisi@example.com",
      "age": 30,
      "department": "销售部"
    }
  ]
}
```

用户描述：`提取所有用户的姓名和邮箱`

### 生成的代码

```javascript
// 提取所有用户的姓名和邮箱
try {
  const users = json.users || []
  return users.map(user => ({
    name: user.name,
    email: user.email
  })).filter(user => user.name && user.email)
} catch (error) {
  return []
}
```

## 注意事项

1. **API密钥安全**：密钥仅保存在本地浏览器中，不会上传到服务器
2. **网络连接**：需要网络连接才能调用OpenAI API
3. **API配额**：请注意OpenAI API的使用配额限制
4. **代码审查**：建议在使用生成的代码前进行审查和测试

## 故障排除

### 常见问题

1. **API密钥无效**：检查密钥是否正确输入
2. **网络错误**：检查网络连接和防火墙设置
3. **生成失败**：确保描述清晰具体，避免过于复杂的要求

### 错误信息

组件会显示详细的错误信息，帮助用户诊断问题：

- API密钥相关错误
- 网络连接错误
- OpenAI API响应错误
- 代码生成错误 